<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>
    <meta name="author" content="">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

    <div id="imprimir">
        <p>Hello, world!</p>
        <p>Hello, world!</p>
        <p>Hello, world!</p>
        <strong>Hello</strong>
        <strong>Hello</strong>
        <strong>Hello</strong>
        <strong>Hello</strong>
        <strong>Hello</strong>
        <strong>Hello</strong>
        <p>Hello, world!</p>
        <p>Hello, world!</p>
        <p>Hello, world!</p>
        <p>Hello, world!</p>

        <img src="mulher.jpg">
    </div>

    <canvas id="c" width="500" height="400"></canvas>

    <script src="node_modules/html-to-image/dist/html-to-image.js"></script>
    <!-- <script src="js/script.js"></script> -->

    <script>
        htmlToImage.toCanvas(imprimir).then(function (canvas) {
            let buffer = make_bw_buffer(canvas);
        });

        function make_bw_buffer(canvas){
            const threshold = 127;

            let ctx = canvas.getContext("2d")
            let idata = ctx.getImageData(0, 0, canvas.width, canvas.height);

            let buffer = [];

            for (let i = 0; i < idata.data.length; i += 4) {
                // get approx. luma value from RGB
                luma = idata.data[i] * 0.3 + idata.data[i + 1] * 0.59 + idata.data[i + 2] * 0.11;

                // test against some threshold
                luma = luma < threshold ? 0 : 255;

                // write result back to all components
                buffer[i] = luma;
                buffer[i + 1] = luma;
                buffer[i + 2] = luma;
            }

            return buffer;
        }
    </script>
</body>

</html>